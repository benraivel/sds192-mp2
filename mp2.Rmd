---
title: "Mini-Project 2"
author: "Ben Raivel, Jordy Perry Greene, Ben Moss-Horwitz"
date: "2019-03-24"
output: 
  html_document:
    code_folding: hide
---


## Loading the data



```{r, message = FALSE}
#Ooh ee ooh ah ah ting tang walla walla bing bang 123
library(tidyverse)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```
ME AND YOU CAN RULE THIS CITY SPIDERMAN!


```{r, message = FALSE}
candidates <- candidates %>%
  rename("fec_id" = cand_id)
```

```{r, message = FALSE}
theFinalSet <- candidates %>%
  inner_join(house_elections, by = "fec_id") %>%
  select(fec_id, candidate_name, cand_party_affiliation, cand_office_state, incumbent, primary_votes, general_votes, ge_winner) %>%
  filter(primary_votes > 0) %>%
  filter(general_votes != 0)
contributionData <- contributions %>%
  select(cand_id, transaction_amt) %>%
  group_by(cand_id) %>%
  summarize(total = sum(transaction_amt), avg = mean(transaction_amt), number = n()) %>%
  filter(number != 0)
contributionData <- contributionData %>%
  rename("fec_id" = cand_id)

theFinalSet <- theFinalSet %>%
  inner_join(contributionData, by = "fec_id")

testSet <- theFinalSet %>%
  group_by(incumbent, ge_winner) %>%
  summarise(money = mean(total))

testSet %>%
  ggplot(aes(x = ge_winner, y = money, fill = ge_winner)) +
  geom_col()+
  facet_wrap("incumbent")
  
```

```{r, message = FALSE}
theFinalSet %>%
  ggplot(aes(x = total, y = general_votes, color = ge_winner)) +
  geom_point(aes(alpha = 0.5)) +
  #scale_x_continuous(trans='log2') + 
  geom_smooth() +
  facet_wrap("incumbent")
```

```{r, message = FALSE}
theFinalSet %>%
  ggplot(aes(y = general_votes, x = total)) +
  geom_point(aes(alpha = 0.5, color = ge_winner)) +
  scale_x_continuous(trans='log2') + 
  facet_wrap("incumbent") + 
  xlab("Total Contributions") + 
  ylab("Total Votes")
```
